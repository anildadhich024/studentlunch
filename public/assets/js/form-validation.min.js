$(function() {

    /*$("#general_form1").on("submit", function(e) {

        $('#loadingBox').removeClass('d-none');

        $('#loadingmsg').html('Processing Your Request');

    });*/





	$("#general_form").attr("novalidate", "novalidate");

    $("#general_form").on("submit", function(e) {



        

        $(this).find(".invalid-feedback").remove();

        $(this).find(".form-control").removeClass("is-invalid");

        var errorFlag = false;

        var attndFlag = false;

        



        // RegEx Variables

        var PercentageRegEx = /(^100(\.0{1,2})?$)|(^([1-9]([0-9])?|0)(\.[0-9]{1,2})?$)/;

        var CurrencyRegex   = /(^([1-9]([0-9]{1,6})?|0)(\.[0-9]{1,2})?$)/;

        var PFPrcntRegEx    = /^[0-9](\.[0-9]{1,2})|1[1-2](\.[0-9]{1,2})$/;

        var IFSCRegex       = /^[A-Z|a-z]{4}[a-z|A-Z|0-9]{7}$/;

        var SenderIdRegex   = /^[A-Z|a-z]{6}$/;

        var AadhaarNoRegEx  = /^[0-9]{12}$/;

        var UANNoRegEx      = /^[0-9]{12}$/;

        var ESINoRegEx      = /^[0-9]{10}$/;

        var PanNoRegEx      = /^[A-Z|a-z]{5}[0-9]{4}[A-Z|a-z]{1}$/;

        var GSTNoRegEx      = /^[0-9]{2}[A-Z|a-z]{5}[0-9]{4}[A-Z|a-z]{1}[1-9]{1}[a-z|A-Z]{2}$/;

        var PhNoRegEx       = /^[1-9][0-9]{9}$/;

        var XlColRegEx      = /^[A-Z]{1,2}$/;

        var sPhNoRegex      = /^[1-9]{1}[0-9]{9}$/;



        tel     = /^\d+$/;

        mob     = /^[0-9]{10}$/;

        email   = /^([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/;

        stpas   = /^(?=.*[0-9])(?=.*[!@#$%^&*])[a-zA-Z0-9!@#$%^&*]{6,16}$/;



        $(this).find("input, select, textarea, checkbox").each(function() {



            if($(this).prop("required") && $(this).val() == "") {



                $(this).addClass("is-invalid");

                $(this).closest(".form-group").append('<div class="invalid-feedback">Please correct the error</div>');

                errorFlag = true;

            }



            if($(this).attr("type") == "tel" && !tel.test($(this).val())) {



                $(this).addClass("has-danger");

                $(this).closest(".form-group").append('<div class="invalid-feedback">Please enter only numeric value.</div>');

                errorFlag = true;



            }

            if($(this).attr("type") == "email" && $(this).val() != "" && !email.test($(this).val())) {



                $(this).addClass("has-danger");

                $(this).closest(".form-group").append('<div class="invalid-feedback">Please enter valid Email ID.</div>');



                errorFlag = true;



            }

            if($(this).attr("isPercentageField") == "yes") {

                // check the value according to the regex

                if(!PercentageRegEx.test($(this).val())) {

                    $(this).addClass("has-danger");

                    $(this).closest(".form-group").append('<div class="invalid-feedback">Values must be in between 0 & 100 with 2 decimal places</div>');

                    

                    errorFlag = true;

                }

            }

            if($(this).attr("isCurrencyField") == "yes") {

                // check the value according to the regex

                if(!CurrencyRegex.test($(this).val())) {

                    $(this).addClass("has-danger");

                    $(this).closest(".form-group").append('<div class="invalid-feedback">Currency must be in between 0 & 999999 with 2 decimal places are allowed</div>');

                    

                    errorFlag = true;

                }

            }



            if($(this).attr("isPFPrcntFld") == "yes") {

                if($(this).val() > 12) {

                    $(this).addClass("has-danger");

                    $(this).closest(".form-group").append('<div class="invalid-feedback">PF percentage can not be more than 12%</div>');

                    errorFlag = true; 

                }

            }

            



            if($(this).attr("id") == "dEmpAttndDays") {

                var PrsntDays = $(this).val();

                if(PrsntDays == 0) {

                attndFlag = true;



                }

                var Days = $(this).data('mnth');

                if(PrsntDays > Days) {

                    $(this).addClass("has-danger");

                    $(this).closest(".form-group").append('<div class="invalid-feedback">This month has only '+Days+' days</div>');

                    errorFlag = true;

                }



            }



            if($(this).attr("id") == "sIFSCode") {

                if(!IFSCRegex.test($(this).val().trim())) {

                    $(this).addClass("has-danger");

                    $(this).closest(".form-group").append('<div class="invalid-feedback">IFSC is not in valid format</div>');

                    errorFlag = true;

                }

            }

            if($(this).attr("id") == 'image') {

                if($(this).val().length > 0) {

                    if (this.files && this.files[0] && this.files[0].name.match(/\.(jpg|jpeg|png)$/) ) {

                    

                    } else {

                        $(this).addClass("has-danger");

                        $(this).closest(".form-group").append('<div class="invalid-feedback">Only jpg/jpeg/png formats are allowed</div>');

                        errorFlag = true; 

                    }

                }

                

            }

            if($(this).attr("id") == 'AttendanceSheet') {

                if($(this).val().length > 0) {

                    if (this.files && this.files[0] && this.files[0].name.match(/\.(xlsx)$/) ) {

                    

                    } else {

                        $(this).addClass("has-danger");

                        $(this).closest(".form-group").append('<div class="invalid-feedback">Only xlsx format is allowed</div>');

                        errorFlag = true; 

                    }

                }

                

            }



            if($(this).attr("id") == 'sSndrId' && $(this).val() != '') {

                if(!SenderIdRegex.test($(this).val())) {

                   $(this).addClass("has-danger");

                    $(this).closest(".form-group").append('<div class="invalid-feedback">Sendr Id should be 6 characters long</div>');

                    errorFlag = true; 

                }

            }

            if($(this).attr("id") == 'sAadhaar_No' && $(this).val() != '') {

                if(!AadhaarNoRegEx.test($(this).val())) {

                   $(this).addClass("has-danger");

                    $(this).closest(".form-group").append('<div class="invalid-feedback">Aadhaar No. should be 12 digits long</div>');

                    errorFlag = true; 

                }

            }

            if($(this).attr("id") == 'sPAN_No' && $(this).val() != '') {

                if(!PanNoRegEx.test($(this).val())) {

                   $(this).addClass("has-danger");

                    $(this).closest(".form-group").append('<div class="invalid-feedback">PAN No. is not in a valid format</div>');

                    errorFlag = true; 

                }

            }

            if($(this).attr("id") == 'sUAN_No' && $(this).val() != '') {

                if(!UANNoRegEx.test($(this).val())) {

                   $(this).addClass("has-danger");

                    $(this).closest(".form-group").append('<div class="invalid-feedback">UAN No. is not in a valid format</div>');

                    errorFlag = true; 

                }

            }

            if($(this).attr("id") == 'sESI_No' && $(this).val() != '') {

                if(!ESINoRegEx.test($(this).val())) {

                   $(this).addClass("has-danger");

                    $(this).closest(".form-group").append('<div class="invalid-feedback">ESI No. is not in a valid format</div>');

                    errorFlag = true; 

                }

            }



            if($(this).attr("id") == 'sGSTNo' && $(this).val() != '') {

                if(!GSTNoRegEx.test($(this).val())) {

                   $(this).addClass("has-danger");

                    $(this).closest(".form-group").append('<div class="invalid-feedback">GST No. is not in a valid format</div>');

                    errorFlag = true; 

                }

            }



            if($(this).attr("id") == 'sPhNo' && $(this).val() != '') {

                if(!PhNoRegEx.test($(this).val())) {

                   $(this).addClass("has-danger");

                    $(this).closest(".form-group").append('<div class="invalid-feedback">Only numbers allowed & first digit can not be zero</div>');

                    errorFlag = true; 

                }

            }



            if($(this).data("type") == 'XLColValue' && $(this).val() != '') {

                if(!XlColRegEx.test($(this).val())) {

                   $(this).addClass("has-danger");

                    $(this).closest(".form-group").append('<div class="invalid-feedback">Only alphabates upto ZZ are allowed</div>');

                    errorFlag = true; 

                }

            }



            if($(this).data("type") == 'sPhNo' && $(this).val() != '') {

                if(!sPhNoRegex.test($(this).val())) {

                   $(this).addClass("has-danger");

                    $(this).closest(".form-group").append('<div class="invalid-feedback">Phone No. must be 10 digit long</div>');

                    errorFlag = true; 

                }

            }









            // if($(this).attr("type") == "password" && !stpas.test($(this).val())) {



            //     $(this).closest(".form-group").addClass("has-danger").append('<div class="invalid-feedback">Please enter strong password.</div>');



            //     errorFlag = true;



            // }

        });

        if(attndFlag == true) {

            var retval = confirm("You are trying to enter zero present days, Are you sure?");

            if(retval == false) {

                errorFlag = true;

            }

        }

        if(errorFlag) {

            e.preventDefault();

        }

        else

        {

            $('#loadingBox').removeClass('d-none');

            $('#loadingmsg').html('Processing Your Request');

        }





    });



});



function LenCheck(eEvnt, sValue, nLen)

{

    if(sValue.length < nLen) 

    {

        return true;

    }

    else 

    {
        alert("We will use only "+nLen+" words...");
        return false;

    }

}

 function IsMail(eEvnt, sValue, nLen)

{

    if (/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(sValue))
    {
        return (true)
    }
   
    else 

    {
        $('.mail-error').removeClass('d-none');

    }

}

function IsNumber(eEvnt, sValue, nLen)

{

    var nKeyCode = eEvnt.which || eEvnt.keyCode;

    if (nKeyCode >= 48 && nKeyCode <= 57) 

    {

        if(sValue.length < nLen) 

        {

            return true;

        }

        else 

        {

            return false;

        }

    }

    else 

    {

        return false;

    }

}



function IsDecimal(eEvnt, sValue, nLen)

{

    var nKeyCode = eEvnt.which || eEvnt.keyCode;

    if(nKeyCode == 46 || (nKeyCode >= 48 && nKeyCode <= 57)) 

    {

        if(nLen == "") 

        {

            return true;

        }

        else 

        {

            if(sValue.length < nLen) 

            {

                return true;

            }

            else 

            {

                return false;

            }

        }

    }

    else 

    {

        return false;

    }

}